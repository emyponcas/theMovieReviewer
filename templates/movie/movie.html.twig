{% extends 'base.html.twig' %}

{% block title %}Todas las películas{% endblock %}

{% block stylesheets %}
    <style>

        .page-header{
            margin-bottom:32px;
        }

        .page-title{
            font-weight:800;
            font-size:2.2rem;
        }

        .page-subtitle{
            color:var(--text-secondary);
            margin-top:6px;
        }

        .movie-card{
            background:var(--bg-card);
            border-radius:14px;
            overflow:hidden;
            border:1px solid var(--border-color);
            transition:transform .18s ease, box-shadow .18s ease;
            height:100%;
        }

        .movie-card:hover{
            transform:translateY(-6px);
            box-shadow:0 14px 30px rgba(0,0,0,.35);
        }

        .poster{
            width:100%;
            height:420px;
            object-fit:cover;
        }

        .no-poster{
            height:420px;
            display:flex;
            align-items:center;
            justify-content:center;
            background:var(--bg-secondary);
            color:var(--text-secondary);
        }

        .movie-body{
            padding:14px;
        }

        .movie-title{
            font-weight:700;
            font-size:1.05rem;
            margin-bottom:10px;
        }

        .movie-actions{
            display:flex;
            justify-content:space-between;
        }

        .btn-movie{
            border-radius:8px;
            padding:4px 10px;
            font-size:.85rem;
        }


        .search-input,
        .search-select{

            background:var(--bg-secondary);
            border:1px solid var(--border-color);
            color:white;
            height:42px;

        }

        .search-input::placeholder{

            color:rgba(255,255,255,0.75);
            opacity:1;

        }

        .search-input:focus,
        .search-select:focus{

            background:var(--bg-secondary);
            color:white;
            border-color:var(--accent);
            box-shadow:none;

        }

        .search-button{

            height:42px;
            font-weight:600;

        }

    </style>
{% endblock %}

{% block body %}

    <div class="page-header">

        <div class="page-title">
            Todas las películas
        </div>

        <div class="page-subtitle">
            Explora todo el catálogo disponible
        </div>

    </div>

    <form method="get" class="mb-4">

        <div class="row g-3 align-items-center">

            <div class="col-lg-5 col-md-4">

                <input
                        type="text"
                        name="search"
                        value="{{ search }}"
                        class="form-control search-input"
                        placeholder="Buscar película...">

            </div>

            <div class="col-lg-3 col-md-3">

                <select
                        name="language"
                        class="form-select search-select">

                    <option value="">Todos los idiomas</option>

                    <option value="es" {{ language == 'es' ? 'selected' }}>
                        Español
                    </option>

                    <option value="en" {{ language == 'en' ? 'selected' }}>
                        Inglés
                    </option>

                    <option value="fr" {{ language == 'fr' ? 'selected' }}>
                        Francés
                    </option>

                    <option value="it" {{ language == 'it' ? 'selected' }}>
                        Italiano
                    </option>

                </select>

            </div>

            <div class="col-lg-2 col-md-3">

                <select
                        name="year"
                        class="form-select search-select">

                    <option value="">Año</option>

                    {% for y in "now"|date("Y")..1980 %}
                        <option value="{{ y }}" {{ year == y ? 'selected' }}>
                            {{ y }}
                        </option>
                    {% endfor %}

                </select>

            </div>

            <div class="col-lg-2 col-md-2">

                <button class="btn btn-accent w-100 search-button">
                    Buscar
                </button>

            </div>

        </div>

    </form>


    <div class="row g-4">

        {% if movie_list is empty %}

            <div class="col-12">

                <div class="movie-card p-4 text-center">

                    No hay películas disponibles

                </div>

            </div>

        {% endif %}

        {% for movie in movie_list %}

            <div class="col-xl-3 col-lg-4 col-md-6 col-sm-6">

                <div class="movie-card">

                    {% if movie.posterUrl %}

                        <img
                                src="https://image.tmdb.org/t/p/w500{{ movie.posterUrl }}"
                                class="poster"
                                alt="{{ movie.title }}"
                        >

                    {% else %}

                        <div class="no-poster">
                            Sin póster
                        </div>

                    {% endif %}

                    <div class="movie-body">

                        <div class="movie-title">
                            {{ movie.title }}
                        </div>

                        <div class="movie-actions">

                            <a href="{{ path('app_movie_show',{id:movie.id}) }}"
                               class="btn btn-outline-light btn-sm btn-movie">

                                Detalles

                            </a>

                            {% if app.user %}

                                <a href="{{ path('app_movie_show',{id:movie.id}) }}"
                                   class="btn btn-outline-warning btn-sm btn-movie">

                                    Valorar

                                </a>

                            {% else %}

                                <a href="{{ path('app_login') }}"
                                   class="btn btn-outline-warning btn-sm btn-movie">

                                    Login

                                </a>

                            {% endif %}

                        </div>

                    </div>

                </div>

            </div>

        {% endfor %}

    </div>

{% endblock %}
